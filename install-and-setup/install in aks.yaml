1) Download the latest Istio
curl -L https://istio.io/downloadIstio | sh -
cd istio-1.28.0
export PATH=$PWD/bin:$PATH

2)Install Istio using the demo profile
istioctl install --set profile=demo -y


3)Label the default namespace for automatic sidecar injection
kubectl label namespace default istio-injection=enabled --overwrite

4)Deploy Bookinfo application

kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml

5)Apply Istio Gateway + VirtualService (the working, simple method)
cat <<'EOF' > istio-bookinfo-gateway.yaml
apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: bookinfo-gateway
  namespace: istio-system
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - "*"
---
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: bookinfo-vs
  namespace: default
spec:
  hosts:
  - "*"
  gateways:
  - istio-system/bookinfo-gateway
  http:
  - match:
    - uri:
        prefix: /
    route:
    - destination:
        host: productpage
        port:
          number: 9080
EOF

kubectl apply -f istio-bookinfo-gateway.yaml


Wait for pods to be ready:
kubectl get pods

6 â€” Get external IP

kubectl get svc istio-ingressgateway -n istio-system
